<div class="container mt-4">
  <h3 class="mb-4">Compras Realizadas</h3>

  <div *ngIf="carregando" class="text-center my-5">
    <div class="spinner-border text-primary" role="status"></div>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <div *ngIf="!carregando && compras.length === 0" class="alert alert-info">
    Nenhuma compra registrada ainda.
  </div>

  <div *ngFor="let compra of compras" class="card mb-4 shadow-sm border-0"
    [ngClass]="{'border-danger': compra.cancelada}">

    <div class="card-header d-flex justify-content-between align-items-center"
      [ngClass]="compra.cancelada ? 'bg-danger text-white' : 'bg-primary text-white'">
      <span>Compra {{ compra.id }}</span>
      <span>
        <strong>Total: R$ {{ compra.valorTotal | number:'1.2-2' }}</strong>
      </span>
    </div>

    <ul class="list-group list-group-flush">
      <li *ngFor="let item of compra.itens" class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <strong>{{ item.nome }}</strong> x {{ item.quantidade }}
        </div>
        <div>
          R$ {{ item.valor | number:'1.2-2' }}
        </div>
      </li>
    </ul>

    <div class="card-footer text-end" *ngIf="!compra.cancelada">
      <button class="btn btn-outline-danger btn-sm" (click)="cancelarCompra(compra.id)">
        Cancelar Compra
      </button>
    </div>

    <div class="card-footer text-end text-danger fw-bold" *ngIf="compra.cancelada">
      CANCELADA
    </div>

  </div>
</div>