<div class="container my-5 compras-container">

  <!-- HEADER -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold mb-0">Compras Realizadas</h3>
    <span class="text-muted small">
      {{ compras.length }} compra(s)
    </span>
  </div>

  <!-- ERROR -->
  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <!-- EMPTY -->
  <div *ngIf="!carregando && compras.length === 0" class="alert alert-info text-center">
    Nenhuma compra registrada ainda.
  </div>

  <!-- LISTAGEM -->
  <div *ngFor="let compra of compras" class="card compra-card mb-4 border-0">

    <!-- HEADER DO CARD -->
    <div class="card-header d-flex justify-content-between align-items-center"
         [ngClass]="compra.cancelada ? 'header-cancelada' : 'header-ativa'">

      <div>
        <span class="fw-semibold">Compra #{{ compra.id }}</span>
        <div class="small opacity-75">
          {{ compra.itens.length }} item(ns)
        </div>
      </div>

      <div class="text-end">
        <div class="fw-bold fs-5">
          R$ {{ compra.valorTotal | number:'1.2-2' }}
        </div>

        <span *ngIf="!compra.cancelada"
              class="badge bg-success-subtle text-success">
          Concluída
        </span>

        <span *ngIf="compra.cancelada"
              class="badge bg-danger-subtle text-danger">
          Cancelada
        </span>
      </div>
    </div>

    <!-- ITENS -->
    <ul class="list-group list-group-flush">
      <li *ngFor="let item of compra.itens"
          class="list-group-item item-compra d-flex justify-content-between align-items-center">

        <div>
          <div class="fw-medium">{{ item.nome }}</div>
          <small class="text-muted">Qtd: {{ item.quantidade }}</small>
        </div>

        <div class="fw-semibold">
          R$ {{ item.valor | number:'1.2-2' }}
        </div>
      </li>
    </ul>

    <!-- FOOTER AÇÃO -->
    <div class="card-footer d-flex justify-content-end gap-2"
         *ngIf="!compra.cancelada">
      <button class="btn btn-outline-danger btn-sm"
              (click)="cancelarCompra(compra.id)">
        Cancelar Compra
      </button>
    </div>

    <!-- FOOTER CANCELADA -->
    <div class="card-footer footer-cancelada text-center"
         *ngIf="compra.cancelada">
      CANCELADA
    </div>

  </div>
</div>
